import r from"xlsx";var e={stox:function(e){var o=[];return e.SheetNames.forEach((function(t){var l={name:t,rows:{},cols:{},merges:[],styles:[]},s=e.Sheets[t],n=r.utils.sheet_to_json(s,{raw:!1,header:1}),a=0;(n.forEach((function(e,o){var t={};e.forEach((function(e,n){var c=r.utils.encode_cell({c:n,r:o});if(t[n]={text:e},s[c].s){var i=s[c].s,f={};if(i.fill){var g=i.fill.fgColor.rgb;g&&6==g.length?f.bgcolor="#"+g:g&&8==g.length&&(f.bgcolor="#"+g.slice(2))}if(i.font&&(f.font={bold:i.font.bold||!1,size:Number(i.font.sz||11)},i.font.color)){var v=i.font.color.rgb;v&&6==v.length?f.color="000000"==v?"#FFFFFF":"FFFFFF"==v?"#000000":"#"+v:v&&8==v.length&&(f.color="#"+v.slice(2))}if(i.border)for(var b in f.border={},i.border)if(i.border[b].color){var h=i.border[b].color;h.auto&&"1"==h.auto&&(f.border[b]=[i.border[b].style,"#000000"]);var u=i.border[b].color.rgb;if(u&&6==u.length){var d="#"+u;f.border[b]=[i.border[b].style,d]}else if(u&&8==u.length){var m="#"+u.slice(2);f.border[b]=[i.border[b].style,m]}}if(i.alignment){var F=i.alignment.horizontal;f.align=F||"center";var w=i.alignment.vertical;f.valign=w&&"center"!=w?w:"middle";var x=i.alignment.wrapText;x&&"1"==x&&(f.textwrap=!0)}t[n].style=a,l.styles[a]=f,a++}})),l.rows[o]={cells:t}})),s["!merges"])&&s["!merges"].forEach((function(e){var o=e.e.r-e.s.r,t=e.e.c-e.s.c,s=r.utils.encode_range(e);l.rows[e.s.r].cells[e.s.c].merge=[o,t],l.merges.push(s)}));s["!cols"]&&s["!cols"].forEach((function(r,e){l.cols[e]={},l.cols[e].width=r.wpx}));o.push(l)})),o},xtos:function(e){var o=r.utils.book_new();return e.forEach((function(e){for(var t=[[]],l=e.rows,s=0;s<l.len;++s){var n=l[s];n&&(t[s]=[],Object.keys(n.cells).forEach((function(r){var e=+r;isNaN(e)||(t[s][e]=n.cells[r].text)})))}var a=r.utils.aoa_to_sheet(t);r.utils.book_append_sheet(o,a,e.name)})),o}};export default e;
