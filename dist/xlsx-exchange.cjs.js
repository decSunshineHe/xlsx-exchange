"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=e(require("xlsx")),o={stox:function(e,o){var t=[];return e.SheetNames.forEach((function(l){var s={name:l,rows:{},cols:{},merges:[],styles:[]},a=e.Sheets[l],n=r.default.utils.sheet_to_json(a,{raw:!1,header:1}),c=0;(n.forEach((function(e,o){var t={};e.forEach((function(e,l){var n=r.default.utils.encode_cell({c:l,r:o});if(t[l]={text:e},a[n].s){var f=a[n].s,i={};if(f.fill){var u=f.fill.fgColor.rgb;u&&6==u.length?i.bgcolor="#"+u:u&&8==u.length&&(i.bgcolor="#"+u.slice(2))}if(f.font&&(i.font={bold:f.font.bold||!1,size:Number(f.font.sz||11)},f.font.color)){var d=f.font.color.rgb;d&&6==d.length?i.color="000000"==d?"#FFFFFF":"FFFFFF"==d?"#000000":"#"+d:d&&8==d.length&&(i.color="#"+d.slice(2))}if(f.border)for(var h in i.border={},f.border)if(f.border[h].color){var g=f.border[h].color;g.auto&&"1"==g.auto&&(i.border[h]=[f.border[h].style,"#000000"]);var v=f.border[h].color.rgb;if(v&&6==v.length){var b="#"+v;i.border[h]=[f.border[h].style,b]}else if(v&&8==v.length){var m="#"+v.slice(2);i.border[h]=[f.border[h].style,m]}}if(f.alignment){var w=f.alignment.horizontal;i.align=w||"center";var F=f.alignment.vertical;i.valign=F&&"center"!=F?F:"middle";var x=f.alignment.wrapText;x&&"1"==x&&(i.textwrap=!0)}t[l].style=c,s.styles[c]=i,c++}})),s.rows[o]={cells:t}})),a["!merges"])&&a["!merges"].forEach((function(e){var o=e.e.r-e.s.r,t=e.e.c-e.s.c,l=r.default.utils.encode_range(e);s.rows[e.s.r].cells[e.s.c].merge=[o,t],s.merges.push(l)}));a["!cols"]&&a["!cols"].forEach((function(e,r){s.cols[r]={},s.cols[r].width=111*e.wpx/100}));if(o&&o.Sheets[l]){var f=o.Sheets[l]["!rows"];f&&f.forEach((function(e,r){s.rows[r].height=5*e.hpx/3}))}t.push(s)})),t},xtos:function(e){var o=r.default.utils.book_new();return e.forEach((function(e){for(var t=[[]],l=e.rows,s=0;s<l.len;++s){var a=l[s];a&&(t[s]=[],Object.keys(a.cells).forEach((function(e){var r=+e;isNaN(r)||(t[s][r]=a.cells[e].text)})))}var n=r.default.utils.aoa_to_sheet(t);r.default.utils.book_append_sheet(o,n,e.name)})),o}};module.exports=o;
