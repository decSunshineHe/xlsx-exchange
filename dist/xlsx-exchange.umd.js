!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["xlsx-exchange"]=t(e.XLSX)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=t(e);return Exchange={stox(e){var t=[];return e.SheetNames.forEach((function(o){var r={name:o,rows:{},merges:[]},n=e.Sheets[o];if(s.default.utils.sheet_to_json(n,{raw:!1,header:1}).forEach((function(e,t){var s={};e.forEach((function(e,t){s[t]={text:e}})),r.rows[t]={cells:s}})),n["!merges"]){n["!merges"].forEach(((e,t)=>{let o=e.e.r-e.s.r,n=e.e.c-e.s.c;r.rows[e.s.r].cells[e.s.c].merge=[o,n];let l=s.default.utils.encode_cell(e.s),a=s.default.utils.encode_cell(e.e);r.merges.push(l+":"+a)}))}t.push(r)})),t},xtos(e){var t=s.default.utils.book_new();return e.forEach((function(e){for(var o=[[]],r=e.rows,n=0;n<r.len;++n){var l=r[n];l&&(o[n]=[],Object.keys(l.cells).forEach((function(e){var t=+e;isNaN(t)||(o[n][t]=l.cells[e].text)})))}var a=s.default.utils.aoa_to_sheet(o);s.default.utils.book_append_sheet(t,a,e.name)})),t}}}));
