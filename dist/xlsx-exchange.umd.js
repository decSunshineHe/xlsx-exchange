!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],o):(e="undefined"!=typeof globalThis?globalThis:e||self)["xlsx-exchange"]=o(e.XLSX)}(this,(function(e){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=o(e);return{stox:function(e){var o=[];return e.SheetNames.forEach((function(t){var l={name:t,rows:{},cols:{},merges:[],styles:[]},n=e.Sheets[t],s=r.default.utils.sheet_to_json(n,{raw:!1,header:1}),f=0;(s.forEach((function(e,o){var t={};e.forEach((function(e,s){var a=r.default.utils.encode_cell({c:s,r:o});if(t[s]={text:e},n[a].s){var c=n[a].s,i={};if(c.fill){var u=c.fill.fgColor.rgb;u&&6==u.length?i.bgcolor="#"+u:u&&8==u.length&&(i.bgcolor="#"+u.slice(2))}if(c.font&&(i.font={bold:c.font.bold||!1,size:c.font.sz||11},c.font.color)){var d=c.font.color.rgb;d&&6==d.length?i.color="000000"==d?"#FFFFFF":"FFFFFF"==d?"#000000":"#"+d:d&&8==d.length&&(i.color="#"+d.slice(2))}if(c.border)for(var h in i.border={},c.border){var g=c.border[h].color.rgb;if(u&&6==u.length){var b=g?"#"+g:"#000000";i.border[h]=[c.border[h].style,b]}else if(u&&8==u.length){var v=g?"#"+g.slice(2):"#000000";i.border[h]=[c.border[h].style,v]}}if(c.alignment){var m=c.alignment.horizontal;i.align=m||"center";var x=c.alignment.vertical;i.valign=x&&"center"!=x?x:"middle"}t[s].style=f,l.styles[f]=i,f++}})),l.rows[o]={cells:t}})),n["!merges"])&&n["!merges"].forEach((function(e){var o=e.e.r-e.s.r,t=e.e.c-e.s.c,n=r.default.utils.encode_range(e);l.rows[e.s.r].cells[e.s.c].merge=[o,t],l.merges.push(n)}));n["!cols"]&&n["!cols"].forEach((function(e,o){l.cols[o]={},l.cols[o].width=e.wpx}));o.push(l)})),o},xtos:function(e){var o=r.default.utils.book_new();return e.forEach((function(e){for(var t=[[]],l=e.rows,n=0;n<l.len;++n){var s=l[n];s&&(t[n]=[],Object.keys(s.cells).forEach((function(e){var o=+e;isNaN(o)||(t[n][o]=s.cells[e].text)})))}var f=r.default.utils.aoa_to_sheet(t);r.default.utils.book_append_sheet(o,f,e.name)})),o}}}));
