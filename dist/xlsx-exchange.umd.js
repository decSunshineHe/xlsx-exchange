!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],r):(e="undefined"!=typeof globalThis?globalThis:e||self)["xlsx-exchange"]=r(e.XLSX)}(this,(function(e){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=r(e);return{stox:function(e,r){var t=[];return e.SheetNames.forEach((function(l){var n={name:l,rows:{},cols:{},merges:[],styles:[]},s=e.Sheets[l],a=o.default.utils.sheet_to_json(s,{raw:!1,header:1}),f=0;(a.forEach((function(e,r){var t={};e.forEach((function(e,l){var a=o.default.utils.encode_cell({c:l,r:r});if(t[l]={text:e},s[a].s){var i=s[a].s,c={};if(i.fill){var u=i.fill.fgColor.rgb;u&&6==u.length?c.bgcolor="#"+u:u&&8==u.length&&(c.bgcolor="#"+u.slice(2))}if(i.font&&(c.font={bold:i.font.bold||!1,size:Number(i.font.sz||11)},i.font.color)){var d=i.font.color.rgb;d&&6==d.length?c.color="000000"==d?"#FFFFFF":"FFFFFF"==d?"#000000":"#"+d:d&&8==d.length&&(c.color="#"+d.slice(2))}if(i.border)for(var h in c.border={},i.border)if(i.border[h].color){var g=i.border[h].color;g.auto&&"1"==g.auto&&(c.border[h]=[i.border[h].style,"#000000"]);var b=i.border[h].color.rgb;if(b&&6==b.length){var v="#"+b;c.border[h]=[i.border[h].style,v]}else if(b&&8==b.length){var m="#"+b.slice(2);c.border[h]=[i.border[h].style,m]}}if(i.alignment){var x=i.alignment.horizontal;c.align=x||"center";var p=i.alignment.vertical;c.valign=p&&"center"!=p?p:"middle";var w=i.alignment.wrapText;w&&"1"==w&&(c.textwrap=!0)}t[l].style=f,n.styles[f]=c,f++}})),n.rows[r]={cells:t}})),s["!merges"])&&s["!merges"].forEach((function(e){var r=e.e.r-e.s.r,t=e.e.c-e.s.c,l=o.default.utils.encode_range(e);n.rows[e.s.r].cells[e.s.c].merge=[r,t],n.merges.push(l)}));s["!cols"]&&s["!cols"].forEach((function(e,r){n.cols[r]={},n.cols[r].width=111*e.wpx/100}));if(r&&r.Sheets[l]){var i=r.Sheets[l]["!rows"];i&&i.forEach((function(e,r){n.rows[r].height=5*e.hpx/3}))}t.push(n)})),t},xtos:function(e){var r=o.default.utils.book_new();return e.forEach((function(e){for(var t=[[]],l=e.rows,n=0;n<l.len;++n){var s=l[n];s&&(t[n]=[],Object.keys(s.cells).forEach((function(e){var r=+e;isNaN(r)||(t[n][r]=s.cells[e].text)})))}var a=o.default.utils.aoa_to_sheet(t);o.default.utils.book_append_sheet(r,a,e.name)})),r}}}));
