!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],r):(e="undefined"!=typeof globalThis?globalThis:e||self)["xlsx-exchange"]=r(e.XLSX)}(this,(function(e){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=r(e);return{stox:function(e){var r=[];return e.SheetNames.forEach((function(t){var l={name:t,rows:{},cols:{},merges:[],styles:[]},n=e.Sheets[t],s=o.default.utils.sheet_to_json(n,{raw:!1,header:1}),a=0;(s.forEach((function(e,r){var t={};e.forEach((function(e,s){var f=o.default.utils.encode_cell({c:s,r:r});if(t[s]={text:e},n[f].s){var c=n[f].s,i={};if(c.fill){var u=c.fill.fgColor.rgb;u&&6==u.length?i.bgcolor="#"+u:u&&8==u.length&&(i.bgcolor="#"+u.slice(2))}if(c.font&&(i.font={bold:c.font.bold||!1,size:Number(c.font.sz||11)},c.font.color)){var d=c.font.color.rgb;d&&6==d.length?i.color="000000"==d?"#FFFFFF":"FFFFFF"==d?"#000000":"#"+d:d&&8==d.length&&(i.color="#"+d.slice(2))}if(c.border)for(var b in i.border={},c.border)if(c.border[b].color){var g=c.border[b].color;g.auto&&"1"==g.auto&&(i.border[b]=[c.border[b].style,"#000000"]);var h=c.border[b].color.rgb;if(h&&6==h.length){var v="#"+h;i.border[b]=[c.border[b].style,v]}else if(h&&8==h.length){var m="#"+h.slice(2);i.border[b]=[c.border[b].style,m]}}if(c.alignment){var x=c.alignment.horizontal;i.align=x||"center";var p=c.alignment.vertical;i.valign=p&&"center"!=p?p:"middle";var y=c.alignment.wrapText;y&&"1"==y&&(i.textwrap=!0)}t[s].style=a,l.styles[a]=i,a++}})),l.rows[r]={cells:t}})),n["!merges"])&&n["!merges"].forEach((function(e){var r=e.e.r-e.s.r,t=e.e.c-e.s.c,n=o.default.utils.encode_range(e);l.rows[e.s.r].cells[e.s.c].merge=[r,t],l.merges.push(n)}));n["!cols"]&&n["!cols"].forEach((function(e,r){l.cols[r]={},l.cols[r].width=e.wpx}));r.push(l)})),r},xtos:function(e){var r=o.default.utils.book_new();return e.forEach((function(e){for(var t=[[]],l=e.rows,n=0;n<l.len;++n){var s=l[n];s&&(t[n]=[],Object.keys(s.cells).forEach((function(e){var r=+e;isNaN(r)||(t[n][r]=s.cells[e].text)})))}var a=o.default.utils.aoa_to_sheet(t);o.default.utils.book_append_sheet(r,a,e.name)})),r}}}));
