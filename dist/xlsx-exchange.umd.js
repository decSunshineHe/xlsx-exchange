!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["xlsx-exchange"]=t(e.XLSX)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=t(e);return{stox(e){var t=[];return e.SheetNames.forEach((function(o){var r={name:o,rows:{},merges:[]},l=e.Sheets[o];if(s.default.utils.sheet_to_json(l,{raw:!1,header:1}).forEach((function(e,t){var s={};e.forEach((function(e,t){s[t]={text:e}})),r.rows[t]={cells:s}})),l["!merges"]){l["!merges"].forEach(((e,t)=>{let o=e.e.r-e.s.r,l=e.e.c-e.s.c;r.rows[e.s.r].cells[e.s.c].merge=[o,l];let n=s.default.utils.encode_cell(e.s),a=s.default.utils.encode_cell(e.e);r.merges.push(n+":"+a)}))}t.push(r)})),t},xtos(e){var t=s.default.utils.book_new();return e.forEach((function(e){for(var o=[[]],r=e.rows,l=0;l<r.len;++l){var n=r[l];n&&(o[l]=[],Object.keys(n.cells).forEach((function(e){var t=+e;isNaN(t)||(o[l][t]=n.cells[e].text)})))}var a=s.default.utils.aoa_to_sheet(o);s.default.utils.book_append_sheet(t,a,e.name)})),t}}}));
